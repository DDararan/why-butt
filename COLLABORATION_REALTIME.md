# TTT Wiki 실시간 동시편집 시스템

## 🚀 새로운 기능: 실시간 협업 편집

TTT Wiki가 이제 **실시간 동시편집**을 지원합니다! Docmost와 유사한 고급 협업 기능을 제공합니다.

### 🎯 주요 기능

1. **실시간 동시편집**
   - 여러 사용자가 동시에 같은 문서 편집
   - 실시간으로 변경사항 동기화
   - 충돌 없는 자동 병합 (Yjs CRDT)

2. **사용자 커서 표시**
   - 다른 사용자의 커서 위치 실시간 표시
   - 각 사용자별 고유 색상
   - 사용자 이름 표시

3. **온라인 사용자 목록**
   - 현재 문서를 편집 중인 사용자 표시
   - 아바타 그룹으로 시각화
   - 연결 상태 실시간 업데이트

4. **자동 저장 및 동기화**
   - 5초 디바운스로 자동 저장
   - 로컬 IndexedDB 백업
   - 서버와 자동 동기화

## 🛠 기술 스택

### 서버 (Hocuspocus)
- **Hocuspocus Server**: Yjs WebSocket 백엔드
- **인증**: JWT 기반 토큰 인증
- **저장**: 백엔드 API와 통합
- **포트**: 1234 (WebSocket)

### 클라이언트
- **HocuspocusProvider**: WebSocket 연결 관리
- **TipTap Collaboration**: 협업 확장
- **CollaborationCursor**: 커서 표시
- **IndexedDB**: 로컬 캐싱

## 📦 설치 및 실행

### 1. 백엔드 서버 실행
```bash
# Spring Boot 서버 실행
./mvnw spring-boot:run
# 또는
java -jar target/why-butt-1.0.0-SNAPSHOT.jar
```

### 2. Hocuspocus 협업 서버 실행
```bash
cd frontend
npm run hocuspocus
```

### 3. 프론트엔드 개발 서버 실행
```bash
cd frontend
npm start
```

### 4. 모든 서버 한번에 실행
```bash
cd frontend
npm run dev
```

## 🔧 환경 설정

### 포트 설정
- **프론트엔드**: http://localhost:3000
- **백엔드 API**: http://localhost:8181
- **Hocuspocus WebSocket**: ws://localhost:1234

### 사용자 인증
- 로그인 시 자동으로 협업 토큰 생성
- 토큰은 24시간 유효
- 로컬 스토리지에 자동 저장

## 📝 사용 방법

### 1. 로그인
- 기본 사용자명/비밀번호로 로그인
- 협업 토큰이 자동 생성됨

### 2. 문서 편집
- 편집 페이지로 이동
- 자동으로 협업 세션 연결
- 실시간으로 다른 사용자의 편집 확인

### 3. 협업 기능
- **연결 상태**: 우측 상단에 표시
- **온라인 사용자**: 아바타로 표시
- **커서 추적**: 다른 사용자의 커서 실시간 확인

## 🎨 UI/UX 개선사항

### 연결 상태 표시
- 🟡 연결 중...
- 🟢 연결됨
- 🔴 연결 끊김

### 사용자 아바타
- 사용자 이름의 첫 글자 표시
- 랜덤 색상 배정
- 툴팁으로 전체 이름 표시

## 🔍 문제 해결

### 연결 실패 시
1. Hocuspocus 서버 실행 확인
2. 포트 1234가 사용 가능한지 확인
3. 브라우저 콘솔에서 에러 메시지 확인

### 동기화 문제
1. 네트워크 연결 상태 확인
2. 백엔드 API 서버 상태 확인
3. IndexedDB 캐시 정리 (개발자 도구)

### 인증 문제
1. 로그아웃 후 다시 로그인
2. 로컬 스토리지 토큰 확인
3. 백엔드 로그 확인

## 🚀 향후 계획

### 단기 목표
- [ ] 편집 권한 관리 (읽기 전용 모드)
- [ ] 변경 내역 하이라이트
- [ ] 댓글 및 주석 기능

### 중기 목표
- [ ] 오프라인 편집 및 동기화
- [ ] 편집 히스토리 시각화
- [ ] 성능 최적화

### 장기 목표
- [ ] 화상 통화 통합
- [ ] AI 기반 자동 완성
- [ ] 다중 문서 동시 편집

## 🤝 기여하기

실시간 협업 기능은 계속 개선 중입니다. 버그 리포트나 기능 제안은 GitHub Issues를 통해 제출해주세요.

---

**주의사항**: 
- 실시간 협업은 안정적인 네트워크 연결이 필요합니다
- 대용량 문서의 경우 초기 로딩이 느릴 수 있습니다
- 동시 편집자가 많을수록 더 많은 서버 리소스가 필요합니다